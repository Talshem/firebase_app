{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Tal/projects/firebase-hosting-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Users/Tal/projects/firebase-hosting-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Users/Tal/projects/firebase-hosting-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import firebase from\"firebase/app\";import\"firebase/auth\";import\"firebase/firestore\";var firebaseConfig={apiKey:\"AIzaSyBudOcDbB7ISPpGcwEDDFQqH_05qYPMDJA\",authDomain:\"tutorial-288a2.firebaseapp.com\",databaseURL:\"https://tutorial-288a2.firebaseio.com\",projectId:\"tutorial-288a2\",storageBucket:\"tutorial-288a2.appspot.com\",messagingSenderId:\"267092002837\",appId:\"1:267092002837:web:675cae1b8f82d74d67661c\",measurementId:\"G-9F41N0J89R\"};firebase.initializeApp(firebaseConfig);export var auth=firebase.auth();export var firestore=firebase.firestore();var provider=new firebase.auth.GoogleAuthProvider();export var signInWithGoogle=function signInWithGoogle(){auth.signInWithPopup(provider);};export var generateUserDocument=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user,additionalData){var userRef,snapshot,email,displayName,photoURL;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(user){_context.next=2;break;}return _context.abrupt(\"return\");case 2:userRef=firestore.doc(\"users/\".concat(user.uid));_context.next=5;return userRef.get();case 5:snapshot=_context.sent;if(snapshot.exists){_context.next=16;break;}email=user.email,displayName=user.displayName,photoURL=user.photoURL;_context.prev=8;_context.next=11;return userRef.set(_objectSpread({displayName:displayName,email:email,photoURL:photoURL},additionalData));case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);console.error(\"Error creating user document\",_context.t0);case 16:return _context.abrupt(\"return\",getUserDocument(user.uid));case 17:case\"end\":return _context.stop();}}},_callee,null,[[8,13]]);}));return function generateUserDocument(_x,_x2){return _ref.apply(this,arguments);};}();var getUserDocument=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(uid){var userDocument;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(uid){_context2.next=2;break;}return _context2.abrupt(\"return\",null);case 2:_context2.prev=2;_context2.next=5;return firestore.doc(\"users/\".concat(uid)).get();case 5:userDocument=_context2.sent;return _context2.abrupt(\"return\",_objectSpread({uid:uid},userDocument.data()));case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](2);console.error(\"Error fetching user\",_context2.t0);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[2,9]]);}));return function getUserDocument(_x3){return _ref2.apply(this,arguments);};}();","map":{"version":3,"sources":["C:/Users/Tal/projects/firebase-hosting-demo/src/firebase.js"],"names":["firebase","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","initializeApp","auth","firestore","provider","GoogleAuthProvider","signInWithGoogle","signInWithPopup","generateUserDocument","user","additionalData","userRef","doc","uid","get","snapshot","exists","email","displayName","photoURL","set","console","error","getUserDocument","userDocument","data"],"mappings":"keAAA,MAAOA,CAAAA,QAAP,KAAqB,cAArB,CACA,MAAO,eAAP,CACA,MAAO,oBAAP,CAEA,GAAMC,CAAAA,cAAc,CAAG,CACnBC,MAAM,CAAE,yCADW,CAEnBC,UAAU,CAAE,gCAFO,CAGnBC,WAAW,CAAE,uCAHM,CAInBC,SAAS,CAAE,gBAJQ,CAKnBC,aAAa,CAAE,4BALI,CAMnBC,iBAAiB,CAAE,cANA,CAOnBC,KAAK,CAAE,2CAPY,CAQnBC,aAAa,CAAE,cARI,CAAvB,CAWAT,QAAQ,CAACU,aAAT,CAAuBT,cAAvB,EACA,MAAO,IAAMU,CAAAA,IAAI,CAAGX,QAAQ,CAACW,IAAT,EAAb,CAEP,MAAO,IAAMC,CAAAA,SAAS,CAAGZ,QAAQ,CAACY,SAAT,EAAlB,CAEP,GAAMC,CAAAA,QAAQ,CAAG,GAAIb,CAAAA,QAAQ,CAACW,IAAT,CAAcG,kBAAlB,EAAjB,CAEA,MAAO,IAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAClCJ,IAAI,CAACK,eAAL,CAAqBH,QAArB,EACD,CAFI,CAIP,MAAO,IAAMI,CAAAA,oBAAoB,0FAAG,iBAAOC,IAAP,CAAaC,cAAb,qKAC7BD,IAD6B,iEAE5BE,OAF4B,CAElBR,SAAS,CAACS,GAAV,iBAAuBH,IAAI,CAACI,GAA5B,EAFkB,uBAGXF,CAAAA,OAAO,CAACG,GAAR,EAHW,QAG5BC,QAH4B,kBAI7BA,QAAQ,CAACC,MAJoB,0BAKxBC,KALwB,CAKSR,IALT,CAKxBQ,KALwB,CAKjBC,WALiB,CAKST,IALT,CAKjBS,WALiB,CAKJC,QALI,CAKSV,IALT,CAKJU,QALI,wCAOxBR,CAAAA,OAAO,CAACS,GAAR,gBACJF,WAAW,CAAXA,WADI,CAEJD,KAAK,CAALA,KAFI,CAGJE,QAAQ,CAARA,QAHI,EAIDT,cAJC,EAPwB,0FAc9BW,OAAO,CAACC,KAAR,CAAc,8BAAd,cAd8B,wCAiB3BC,eAAe,CAACd,IAAI,CAACI,GAAN,CAjBY,uEAAH,kBAApBL,CAAAA,oBAAoB,gDAA1B,CAoBP,GAAMe,CAAAA,eAAe,2FAAG,kBAAMV,GAAN,0IACjBA,GADiB,2DACL,IADK,iDAGOV,CAAAA,SAAS,CAACS,GAAV,iBAAuBC,GAAvB,GAA8BC,GAA9B,EAHP,QAGdU,YAHc,gEAKlBX,GAAG,CAAHA,GALkB,EAMfW,YAAY,CAACC,IAAb,EANe,8DASpBJ,OAAO,CAACC,KAAR,CAAc,qBAAd,eAToB,sEAAH,kBAAfC,CAAAA,eAAe,8CAArB","sourcesContent":["import firebase from \"firebase/app\";\r\nimport \"firebase/auth\";\r\nimport \"firebase/firestore\";\r\n\r\nconst firebaseConfig = {\r\n    apiKey: \"AIzaSyBudOcDbB7ISPpGcwEDDFQqH_05qYPMDJA\",\r\n    authDomain: \"tutorial-288a2.firebaseapp.com\",\r\n    databaseURL: \"https://tutorial-288a2.firebaseio.com\",\r\n    projectId: \"tutorial-288a2\",\r\n    storageBucket: \"tutorial-288a2.appspot.com\",\r\n    messagingSenderId: \"267092002837\",\r\n    appId: \"1:267092002837:web:675cae1b8f82d74d67661c\",\r\n    measurementId: \"G-9F41N0J89R\"\r\n  };\r\n\r\nfirebase.initializeApp(firebaseConfig);\r\nexport const auth = firebase.auth();\r\n\r\nexport const firestore = firebase.firestore();\r\n\r\nconst provider = new firebase.auth.GoogleAuthProvider();\r\n\r\nexport const signInWithGoogle = () => {\r\n    auth.signInWithPopup(provider);\r\n  };\r\n\r\nexport const generateUserDocument = async (user, additionalData) => {\r\n  if (!user) return;\r\n  const userRef = firestore.doc(`users/${user.uid}`);\r\n  const snapshot = await userRef.get();\r\n  if (!snapshot.exists) {\r\n    const { email, displayName, photoURL } = user;\r\n    try {\r\n      await userRef.set({\r\n        displayName,\r\n        email,\r\n        photoURL,\r\n        ...additionalData\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error creating user document\", error);\r\n    }\r\n  }\r\n  return getUserDocument(user.uid);\r\n};\r\n\r\nconst getUserDocument = async uid => {\r\n  if (!uid) return null;\r\n  try {\r\n    const userDocument = await firestore.doc(`users/${uid}`).get();\r\n    return {\r\n      uid,\r\n      ...userDocument.data()\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Error fetching user\", error);\r\n  }\r\n};"]},"metadata":{},"sourceType":"module"}