{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Tal/projects/firebase-hosting-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Users/Tal/projects/firebase-hosting-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Users/Tal/projects/firebase-hosting-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";var firebaseConfig={apiKey:\"AIzaSyBudOcDbB7ISPpGcwEDDFQqH_05qYPMDJA\",authDomain:\"tutorial-288a2.firebaseapp.com\",databaseURL:\"https://tutorial-288a2.firebaseio.com\",projectId:\"tutorial-288a2\",storageBucket:\"tutorial-288a2.appspot.com\",messagingSenderId:\"267092002837\",appId:\"1:267092002837:web:675cae1b8f82d74d67661c\",measurementId:\"G-9F41N0J89R\"};firebase.initializeApp(firebaseConfig);export var auth=firebase.auth();export var firestore=firebase.firestore();var provider=new firebase.auth.GoogleAuthProvider();export var signInWithGoogle=function signInWithGoogle(){auth.signInWithPopup(provider);};var userRef=firestore.doc(\"users/\".concat(user.uid));var snapshot=await userRef.get();export var generateUserDocument=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user,additionalData){var userRef,snapshot,email,displayName,photoURL;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(user){_context.next=2;break;}return _context.abrupt(\"return\");case 2:userRef=firestore.doc(\"users/\".concat(user.uid));_context.next=5;return userRef.get();case 5:snapshot=_context.sent;if(snapshot.exists){_context.next=16;break;}email=user.email,displayName=user.displayName,photoURL=user.photoURL;_context.prev=8;_context.next=11;return userRef.set(_objectSpread({displayName:displayName,email:email,photoURL:photoURL},additionalData));case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);console.error(\"Error creating user document\",_context.t0);case 16:return _context.abrupt(\"return\",getUserDocument(user.uid));case 17:case\"end\":return _context.stop();}}},_callee,null,[[8,13]]);}));return function generateUserDocument(_x,_x2){return _ref.apply(this,arguments);};}();var getUserDocument=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(uid){var userDocument;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(uid){_context2.next=2;break;}return _context2.abrupt(\"return\",null);case 2:_context2.prev=2;_context2.next=5;return firestore.doc(\"users/\".concat(uid)).get();case 5:userDocument=_context2.sent;return _context2.abrupt(\"return\",_objectSpread({uid:uid},userDocument.data()));case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](2);console.error(\"Error fetching user\",_context2.t0);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[2,9]]);}));return function getUserDocument(_x3){return _ref2.apply(this,arguments);};}();","map":{"version":3,"sources":["C:/Users/Tal/projects/firebase-hosting-demo/src/firebase.js"],"names":["firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firebase","initializeApp","auth","firestore","provider","GoogleAuthProvider","signInWithGoogle","signInWithPopup","userRef","doc","user","uid","snapshot","get","generateUserDocument","additionalData","exists","email","displayName","photoURL","set","console","error","getUserDocument","userDocument","data"],"mappings":"keAAA,GAAMA,CAAAA,cAAc,CAAG,CACnBC,MAAM,CAAE,yCADW,CAEnBC,UAAU,CAAE,gCAFO,CAGnBC,WAAW,CAAE,uCAHM,CAInBC,SAAS,CAAE,gBAJQ,CAKnBC,aAAa,CAAE,4BALI,CAMnBC,iBAAiB,CAAE,cANA,CAOnBC,KAAK,CAAE,2CAPY,CAQnBC,aAAa,CAAE,cARI,CAAvB,CAWAC,QAAQ,CAACC,aAAT,CAAuBV,cAAvB,EACA,MAAO,IAAMW,CAAAA,IAAI,CAAGF,QAAQ,CAACE,IAAT,EAAb,CACP,MAAO,IAAMC,CAAAA,SAAS,CAAGH,QAAQ,CAACG,SAAT,EAAlB,CACP,GAAMC,CAAAA,QAAQ,CAAG,GAAIJ,CAAAA,QAAQ,CAACE,IAAT,CAAcG,kBAAlB,EAAjB,CACA,MAAO,IAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAClCJ,IAAI,CAACK,eAAL,CAAqBH,QAArB,EACD,CAFI,CAGP,GAAMI,CAAAA,OAAO,CAAGL,SAAS,CAACM,GAAV,iBAAuBC,IAAI,CAACC,GAA5B,EAAhB,CACA,GAAMC,CAAAA,QAAQ,CAAG,KAAMJ,CAAAA,OAAO,CAACK,GAAR,EAAvB,CAEA,MAAO,IAAMC,CAAAA,oBAAoB,0FAAG,iBAAOJ,IAAP,CAAaK,cAAb,qKAC7BL,IAD6B,iEAE5BF,OAF4B,CAElBL,SAAS,CAACM,GAAV,iBAAuBC,IAAI,CAACC,GAA5B,EAFkB,uBAGXH,CAAAA,OAAO,CAACK,GAAR,EAHW,QAG5BD,QAH4B,kBAI7BA,QAAQ,CAACI,MAJoB,0BAKxBC,KALwB,CAKSP,IALT,CAKxBO,KALwB,CAKjBC,WALiB,CAKSR,IALT,CAKjBQ,WALiB,CAKJC,QALI,CAKST,IALT,CAKJS,QALI,wCAOxBX,CAAAA,OAAO,CAACY,GAAR,gBACJF,WAAW,CAAXA,WADI,CAEJD,KAAK,CAALA,KAFI,CAGJE,QAAQ,CAARA,QAHI,EAIDJ,cAJC,EAPwB,0FAc9BM,OAAO,CAACC,KAAR,CAAc,8BAAd,cAd8B,wCAiB3BC,eAAe,CAACb,IAAI,CAACC,GAAN,CAjBY,uEAAH,kBAApBG,CAAAA,oBAAoB,gDAA1B,CAmBP,GAAMS,CAAAA,eAAe,2FAAG,kBAAMZ,GAAN,0IACjBA,GADiB,2DACL,IADK,iDAGOR,CAAAA,SAAS,CAACM,GAAV,iBAAuBE,GAAvB,GAA8BE,GAA9B,EAHP,QAGdW,YAHc,gEAKlBb,GAAG,CAAHA,GALkB,EAMfa,YAAY,CAACC,IAAb,EANe,8DASpBJ,OAAO,CAACC,KAAR,CAAc,qBAAd,eAToB,sEAAH,kBAAfC,CAAAA,eAAe,8CAArB","sourcesContent":["const firebaseConfig = {\r\n    apiKey: \"AIzaSyBudOcDbB7ISPpGcwEDDFQqH_05qYPMDJA\",\r\n    authDomain: \"tutorial-288a2.firebaseapp.com\",\r\n    databaseURL: \"https://tutorial-288a2.firebaseio.com\",\r\n    projectId: \"tutorial-288a2\",\r\n    storageBucket: \"tutorial-288a2.appspot.com\",\r\n    messagingSenderId: \"267092002837\",\r\n    appId: \"1:267092002837:web:675cae1b8f82d74d67661c\",\r\n    measurementId: \"G-9F41N0J89R\"\r\n  };\r\n\r\nfirebase.initializeApp(firebaseConfig);\r\nexport const auth = firebase.auth();\r\nexport const firestore = firebase.firestore();\r\nconst provider = new firebase.auth.GoogleAuthProvider();\r\nexport const signInWithGoogle = () => {\r\n    auth.signInWithPopup(provider);\r\n  };\r\nconst userRef = firestore.doc(`users/${user.uid}`);\r\nconst snapshot = await userRef.get();\r\n\r\nexport const generateUserDocument = async (user, additionalData) => {\r\n  if (!user) return;\r\n  const userRef = firestore.doc(`users/${user.uid}`);\r\n  const snapshot = await userRef.get();\r\n  if (!snapshot.exists) {\r\n    const { email, displayName, photoURL } = user;\r\n    try {\r\n      await userRef.set({\r\n        displayName,\r\n        email,\r\n        photoURL,\r\n        ...additionalData\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error creating user document\", error);\r\n    }\r\n  }\r\n  return getUserDocument(user.uid);\r\n};\r\nconst getUserDocument = async uid => {\r\n  if (!uid) return null;\r\n  try {\r\n    const userDocument = await firestore.doc(`users/${uid}`).get();\r\n    return {\r\n      uid,\r\n      ...userDocument.data()\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Error fetching user\", error);\r\n  }\r\n};"]},"metadata":{},"sourceType":"module"}